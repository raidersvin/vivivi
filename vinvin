-- ğŸ“‹ Danh sÃ¡ch ngÆ°á»i nháº­n
local recipients = {"Hannah_Hunt3r2022","XxEllie_GoldenxX2021","LIONBLAZEHERO2003_YT","XxG0ldenSparklyxX16","MasonSlim3Vort3x","FireFr0stTiger2007","EchoUltra2006_YT","NinjaStreamPixel","Her0SaberPrism96","BlizzardNightSab3r"}

-- ğŸ’¬ Danh sÃ¡ch lá»i chÃºc
local messages = {
    "Happy Birthday %s!",
    "Hope today brings %s!",
    "Wishing you luck %s!",
    "Congrats on your %s!",
    "Give away %s!",
    "You are amazing %s â€” here's a gift!"
}

-- âš™ï¸ Diamonds gá»­i
local DIAMOND_AMOUNT = 20000000

-- ğŸ“¦ Load module
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Client = ReplicatedStorage:WaitForChild("Library"):WaitForChild("Client")
local Network = require(Client.Network)
local SaveData = require(Client.Save).Get()

-- ğŸ’ Láº¥y UID Diamonds
local diamondsUID = nil
for uid, v in pairs(SaveData.Inventory["Currency"]) do
    if v.id == "Diamonds" then
        diamondsUID = uid
        break
    end
end

if not diamondsUID then
    warn("âŒ KhÃ´ng tÃ¬m tháº¥y UID cá»§a Diamonds.")
    return
end

-- ğŸ§  Pet manager
local Manager = {}
function Manager:GetPets(name_pet, PT_yeucau)
    local Huges = {}
    for uid, v in pairs(SaveData.Inventory.Pet) do
        if string.find(v.id, name_pet) then
            if (PT_yeucau == nil and v.pt == nil) or (PT_yeucau ~= nil and v.pt == PT_yeucau) then
                table.insert(Huges, {
                    UID = uid,
                    SH = v.sh,
                    PT = v.pt,
                    Count = v._am or 1
                })
            end
        end
    end
    return Huges
end

-- ğŸ” Láº¥y 1 Pet Ä‘á»ƒ gá»­i
local listPet = Manager:GetPets("Wisp Wolf", 2)
local pet = listPet[1]

if not pet then
    warn("âŒ KhÃ´ng tÃ¬m tháº¥y pet phÃ¹ há»£p!")
    return
end

-- Danh sÃ¡ch lá»—i riÃªng biá»‡t
local failedPetList = {}
local failedGemList = {}

-- ğŸš€ VÃ²ng gá»­i láº§n Ä‘áº§u
for index, username in ipairs(recipients) do
    local petMsg = string.format(messages[math.random(1, #messages)], username)
    local petSuccess, petErr = Network.Invoke("Mailbox: Send", username, petMsg, "Pet", pet.UID, 50)

    if petSuccess then
        warn("âœ… [" .. index .. "/" .. #recipients .. "] Pet sent to " .. username)
    else
        warn("âŒ [" .. index .. "/" .. #recipients .. "] Failed to send PET to " .. username .. ": " .. tostring(petErr))
        table.insert(failedPetList, username)
    end

    task.wait(2)

    local gemMsg = string.format(messages[math.random(1, #messages)], username)
    local gemSuccess, gemErr = Network.Invoke("Mailbox: Send", username, gemMsg, "Currency", diamondsUID, DIAMOND_AMOUNT)

    if gemSuccess then
        warn("âœ… [" .. index .. "/" .. #recipients .. "] Gems sent to " .. username)
    else
        warn("âŒ [" .. index .. "/" .. #recipients .. "] Failed to send GEMS to " .. username .. ": " .. tostring(gemErr))
        table.insert(failedGemList, username)
    end

    task.wait(3)
end

-- ğŸ” Gá»­i láº¡i Pet náº¿u lá»—i
if #failedPetList > 0 then
    warn("ğŸ” Äang thá»­ gá»­i láº¡i PET...")
    for _, username in ipairs(failedPetList) do
        local retryMsg = string.format(messages[math.random(1, #messages)], username)
        local success, err = Network.Invoke("Mailbox: Send", username, retryMsg, "Pet", pet.UID, 50)

        if success then
            warn("âœ… [Retry PET] Sent to " .. username)
        else
            warn("âŒ [Retry PET] Failed to " .. username .. ": " .. tostring(err))
        end

        task.wait(2)
    end
end

-- ğŸ” Gá»­i láº¡i Gems náº¿u lá»—i
if #failedGemList > 0 then
    warn("ğŸ” Äang thá»­ gá»­i láº¡i GEMS...")
    for _, username in ipairs(failedGemList) do
        local retryMsg = string.format(messages[math.random(1, #messages)], username)
        local success, err = Network.Invoke("Mailbox: Send", username, retryMsg, "Currency", diamondsUID, DIAMOND_AMOUNT)

        if success then
            warn("âœ… [Retry GEM] Sent to " .. username)
        else
            warn("âŒ [Retry GEM] Failed to " .. username .. ": " .. tostring(err))
        end

        task.wait(2)
    end
end

